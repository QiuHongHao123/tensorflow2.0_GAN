import tensorflow as tf
'''
11.21
æœ‰å…³å‘é‡
'''
def about_add():
    '''
    è€ƒè™‘ 2 ä¸ªè¾“å‡ºèŠ‚ç‚¹çš„ç½‘ç»œå±‚ï¼Œæˆ‘ä»¬åˆ›å»ºé•¿åº¦ä¸º 2 çš„åç½®å‘é‡ğ’ƒï¼Œå¹¶ç´¯åŠ åœ¨æ¯ä¸ªè¾“å‡ºèŠ‚ç‚¹
    '''
    z=tf.random.normal([4,2])
    b=tf.zeros([2])
    '''
    æ³¨æ„åˆ°è¿™é‡Œ shape ä¸º[4,2]çš„ğ’›å’Œ shape ä¸º[2]çš„ğ’ƒå¼ é‡å¯ä»¥ç›´æ¥ç›¸åŠ ï¼Œè¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿè®©æˆ‘ä»¬ åœ¨ Broadcasting ä¸€èŠ‚ä¸ºå¤§å®¶æ­ç§˜ã€‚ 
    '''
    print(z+b)
def about_bias():
    '''
    é€šè¿‡é«˜å±‚æ¥å£ç±» Dense()æ–¹å¼åˆ›å»ºçš„ç½‘ç»œå±‚ï¼Œå¼ é‡ W å’Œğ’ƒå­˜å‚¨åœ¨ç±»çš„å†…éƒ¨ï¼Œç”±ç±»è‡ªåŠ¨åˆ› å»ºå¹¶ç®¡ç†ã€‚å¯ä»¥é€šè¿‡å…¨è¿æ¥å±‚çš„ bias æˆå‘˜å˜é‡æŸ¥çœ‹åç½®å˜é‡ğ’ƒï¼Œ
    ä¾‹å¦‚åˆ›å»ºè¾“å…¥èŠ‚ç‚¹æ•°ä¸º 4ï¼Œ è¾“å‡ºèŠ‚ç‚¹æ•°ä¸º 3 çš„çº¿æ€§å±‚ç½‘ç»œï¼Œé‚£ä¹ˆå®ƒçš„åç½®å‘é‡ b çš„é•¿åº¦åº”ä¸º 3
    '''
    fc=tf.keras.layers.Dense(3)  # åˆ›å»ºä¸€å±‚ Wx+bï¼Œè¾“å‡ºèŠ‚ç‚¹ä¸º 3
    fc.build(input_shape=(2,4))# é€šè¿‡ build å‡½æ•°åˆ›å»º W,b å¼ é‡ï¼Œè¾“å…¥èŠ‚ç‚¹ä¸º 4
    print(fc.bias)
def constant_3D():
    '''
    ä¸‰ç»´çš„å¼ é‡ä¸€ä¸ªå…¸å‹åº”ç”¨æ˜¯è¡¨ç¤ºåºåˆ—ä¿¡å·ï¼Œå®ƒçš„æ ¼å¼æ˜¯ ğ‘‹ = [ğ‘,ğ‘ ğ‘’ğ‘ğ‘¢ğ‘’ğ‘›ğ‘ğ‘’ ğ‘™ğ‘’ğ‘›,ğ‘“ğ‘’ğ‘ğ‘¡ğ‘¢ğ‘Ÿğ‘’ ğ‘™ğ‘’ğ‘›] å…¶ä¸­ğ‘è¡¨ç¤ºåºåˆ—ä¿¡å·çš„æ•°é‡ï¼Œsequence len è¡¨ç¤ºåºåˆ—ä¿¡å·åœ¨æ—¶é—´ç»´åº¦ä¸Šçš„é‡‡æ ·ç‚¹æ•°ï¼Œfeature len è¡¨ç¤ºæ¯ä¸ªç‚¹çš„ç‰¹å¾é•¿åº¦ã€‚
    è€ƒè™‘è‡ªç„¶è¯­è¨€å¤„ç†ä¸­å¥å­çš„è¡¨ç¤ºï¼Œå¦‚è¯„ä»·å¥å­çš„æ˜¯å¦ä¸ºæ­£é¢æƒ…ç»ªçš„æƒ…æ„Ÿåˆ†ç±»ä»»åŠ¡ç½‘ ç»œï¼Œ
    ä¸ºäº†èƒ½å¤Ÿæ–¹ä¾¿å­—ç¬¦ä¸²è¢«ç¥ç»ç½‘ç»œå¤„ç†ï¼Œä¸€èˆ¬å°†å•è¯é€šè¿‡åµŒå…¥å±‚(Embedding Layer)ç¼–ç ä¸ºå›ºå®šé•¿åº¦çš„å‘é‡ï¼Œ
    æ¯”å¦‚â€œaâ€ç¼–ç ä¸ºæŸä¸ªé•¿åº¦ 3 çš„å‘é‡ï¼Œé‚£ä¹ˆ 2 ä¸ª ç­‰é•¿(å•è¯æ•°ä¸º 5)çš„å¥å­åºåˆ—å¯ä»¥è¡¨ç¤ºä¸º shape ä¸º[2,5,3]çš„ 3 ç»´å¼ é‡ï¼Œ
    å…¶ä¸­ 2 è¡¨ç¤ºå¥å­ä¸ª æ•°ï¼Œ5 è¡¨ç¤ºå•è¯æ•°é‡ï¼Œ3 è¡¨ç¤ºå•è¯å‘é‡çš„é•¿åº¦ï¼š
    :return:
    '''
    (x_train,y_train),(x_test,y_test)=tf.keras.datasets.imdb.load_data(num_words=10000)
    print(x_train.shape)

    x_train=tf.keras.preprocessing.sequence.pad_sequences(x_train,maxlen=80)
    print(x_train.shape)
    embedding = tf.keras.layers.Embedding(10000, 100)
    out=embedding(x_train)
    print(out.shape)
def constant_4D():
    '''
    4 ç»´å¼ é‡åœ¨å·ç§¯ç¥ç»ç½‘ç»œä¸­åº”ç”¨çš„éå¸¸å¹¿æ³›ï¼Œå®ƒç”¨äºä¿å­˜ç‰¹å¾å›¾(Feature maps)æ•°æ®ï¼Œ æ ¼å¼ä¸€èˆ¬å®šä¹‰ä¸º [ğ‘,â„,w,ğ‘]
    å…¶ä¸­ğ‘è¡¨ç¤ºè¾“å…¥çš„æ•°é‡ï¼Œh/wåˆ†å¸ƒè¡¨ç¤ºç‰¹å¾å›¾çš„é«˜å®½ï¼Œğ‘è¡¨ç¤ºç‰¹å¾å›¾çš„é€šé“æ•°ï¼Œéƒ¨åˆ†æ·±åº¦å­¦ä¹ æ¡†æ¶ä¹Ÿä¼šä½¿ç”¨[ğ‘,ğ‘,â„,w]æ ¼å¼çš„ç‰¹å¾å›¾å¼ é‡ï¼Œ
    ä¾‹å¦‚ PyTorchã€‚å›¾ç‰‡æ•°æ®æ˜¯ç‰¹å¾å›¾çš„ä¸€ç§ï¼Œ å¯¹äºå«æœ‰ RGB 3 ä¸ªé€šé“çš„å½©è‰²å›¾ç‰‡ï¼Œæ¯å¼ å›¾ç‰‡åŒ…å«äº† h è¡Œ w åˆ—åƒç´ ç‚¹ï¼Œæ¯ä¸ªç‚¹éœ€è¦ 3 ä¸ªæ•°å€¼è¡¨ç¤º RGB é€šé“çš„é¢œè‰²å¼ºåº¦ï¼Œ
    å› æ­¤ä¸€å¼ å›¾ç‰‡å¯ä»¥è¡¨ç¤ºä¸º[h,w,3]ã€‚å¦‚å›¾ 4.4 æ‰€ç¤ºï¼Œæœ€ä¸Šå±‚ çš„å›¾ç‰‡è¡¨ç¤ºåŸå›¾ï¼Œå®ƒåŒ…å«äº†ä¸‹é¢ 3 ä¸ªé€šé“çš„å¼ºåº¦ä¿¡æ¯ã€‚
    :return:
    '''
    # åˆ›å»º 32x32 çš„å½©è‰²å›¾ç‰‡è¾“å…¥ï¼Œä¸ªæ•°ä¸º 4
    x = tf.random.normal([4,32,32,3])
    # åˆ›å»ºå·ç§¯ç¥ç»ç½‘ç»œ
    layer = tf.keras.layers.Conv2D(16,kernel_size=3)
    out = layer(x)  # å‰å‘è®¡ç®—
    print(out.shape)  # è¾“å‡ºå¤§å°
#about_add()
#about_bias()
#constant_3D()
constant_4D()
